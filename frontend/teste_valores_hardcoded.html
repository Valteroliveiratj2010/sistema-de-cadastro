<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste: Valores Hardcoded Removidos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="style.css?v=2.0" rel="stylesheet">
    <style>
        body { padding: 20px; background: #f8f9fa; }
        .test-container { max-width: 800px; margin: 0 auto; }
        .status-success { color: #059669; font-weight: bold; }
        .status-error { color: #DC2626; font-weight: bold; }
        .status-warning { color: #D97706; font-weight: bold; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üîç Teste: Valores Hardcoded Removidos</h1>
        <p>Verificando se os valores hardcoded (como "R$ 3,83") foram removidos do HTML.</p>
        
        <div class="alert alert-info">
            <h6>üìã Problema Identificado e Corrigido:</h6>
            <ul>
                <li><strong>Problema:</strong> Valores como "R$ 3,83" estavam hardcoded no HTML</li>
                <li><strong>Origem:</strong> HTML est√°tico com valores de exemplo</li>
                <li><strong>Solu√ß√£o:</strong> Removidos valores hardcoded, deixando "R$ 0,00"</li>
                <li><strong>Resultado:</strong> JavaScript agora preenche com dados reais da API</li>
            </ul>
        </div>
        
        <div class="alert alert-success">
            <h6>‚úÖ Valores Corrigidos:</h6>
            <ul>
                <li><strong>Total a Receber:</strong> R$ 13,00 ‚Üí R$ 0,00</li>
                <li><strong>Total a Pagar:</strong> R$ 13,00 ‚Üí R$ 0,00</li>
                <li><strong>Lucro:</strong> R$ 11,50 ‚Üí R$ 0,00</li>
                <li><strong>Valor do Pedido:</strong> R$ 3,83 ‚Üí R$ 0,00</li>
                <li><strong>Ticket M√©dio:</strong> R$ 3,83 ‚Üí R$ 0,00</li>
            </ul>
        </div>
        
        <div class="mt-4">
            <h4>üìä Verifica√ß√£o dos KPIs:</h4>
            <div id="kpiVerification" class="alert alert-secondary">
                <div>üîÑ Verificando valores dos KPIs...</div>
            </div>
        </div>
        
        <div class="mt-4">
            <button class="btn btn-primary" onclick="verificarValores()">
                üîç Verificar Valores
            </button>
            <button class="btn btn-success" onclick="abrirDashboard()">
                üìä Abrir Dashboard
            </button>
            <button class="btn btn-warning" onclick="limparCache()">
                üßπ Limpar Cache
            </button>
        </div>
        
        <div class="mt-4">
            <h5>üìã Instru√ß√µes para Teste:</h5>
            <div class="alert alert-warning">
                <ol>
                    <li><strong>Verifique se n√£o h√° mais valores hardcoded</strong> como "R$ 3,83"</li>
                    <li><strong>Confirme se todos os KPIs mostram "R$ 0,00"</strong> quando n√£o h√° dados</li>
                    <li><strong>Teste no dashboard real</strong> se os valores s√£o preenchidos pela API</li>
                    <li><strong>Se houver dados reais:</strong> Os valores devem vir da API</li>
                    <li><strong>Se n√£o houver dados:</strong> Deve mostrar "R$ 0,00" ou "0"</li>
                </ol>
            </div>
        </div>
        
        <div class="mt-4">
            <h5>üéØ Teste de Simula√ß√£o:</h5>
            <div class="row">
                <div class="col-md-3">
                    <button class="btn btn-outline-primary" onclick="simularDados()">
                        Simular Dados da API
                    </button>
                </div>
                <div class="col-md-3">
                    <button class="btn btn-outline-warning" onclick="limparDados()">
                        Limpar Dados
                    </button>
                </div>
                <div class="col-md-3">
                    <button class="btn btn-outline-info" onclick="testarAPI()">
                        Testar API Real
                    </button>
                </div>
                <div class="col-md-3">
                    <button class="btn btn-outline-success" onclick="verificarHTML()">
                        Verificar HTML
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="js/api.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/i18n/i18n.js"></script>
    <script src="js/app.js?v=1.5"></script>
    
    <script>
        function verificarValores() {
            console.log('üîç Verificando valores dos KPIs...');
            
            const kpis = [
                'totalClients', 'salesThisMonth', 'totalReceivable', 
                'totalAccountsPayable', 'profit', 'orderValue', 
                'averageTicket', 'overdueSales'
            ];
            
            let results = '<h6>üîç Resultado da Verifica√ß√£o:</h6>';
            let problemas = 0;
            let sucessos = 0;
            
            kpis.forEach(id => {
                const element = document.getElementById(id);
                const valueElement = element ? element.querySelector('.fs-2') : null;
                const value = valueElement ? valueElement.textContent : 'N/A';
                
                // Verificar se tem valores hardcoded problem√°ticos
                const valoresProblema = ['R$ 3,83', 'R$ 11,50', 'R$ 13,00', 'R$ 893K', '+12.8%'];
                const temProblema = valoresProblema.some(problema => value.includes(problema));
                
                if (temProblema) {
                    problemas++;
                    results += `<div class="status-error">‚ùå ${id}: ${value} (VALOR HARCODED)</div>`;
                } else {
                    sucessos++;
                    results += `<div class="status-success">‚úÖ ${id}: ${value}</div>`;
                }
            });
            
            if (problemas === 0) {
                results += '<div class="alert alert-success mt-3"><strong>üéâ SUCESSO!</strong> Todos os valores hardcoded foram removidos!</div>';
            } else {
                results += `<div class="alert alert-danger mt-3"><strong>‚ö†Ô∏è ATEN√á√ÉO!</strong> ${problemas} valores hardcoded ainda encontrados.</div>`;
            }
            
            document.getElementById('kpiVerification').innerHTML = results;
        }
        
        function simularDados() {
            console.log('üß™ Simulando dados da API...');
            
            const dadosSimulados = {
                totalClients: 1250,
                salesThisMonth: 15250.75,
                totalReceivable: 8500.50,
                totalAccountsPayable: 3200.25,
                overdueSales: 1200.00,
                orderValue: 450.80,
                averageTicket: 125.30
            };
            
            // Aplicar dados simulados
            Object.entries(dadosSimulados).forEach(([id, value]) => {
                updateKPICard(id, value);
            });
            
            alert('Dados simulados aplicados! Verifique se os KPIs mostram valores diferentes de zero.');
        }
        
        function limparDados() {
            console.log('üßπ Limpando dados...');
            
            const kpis = [
                'totalClients', 'salesThisMonth', 'totalReceivable', 
                'totalAccountsPayable', 'profit', 'orderValue', 
                'averageTicket', 'overdueSales'
            ];
            
            kpis.forEach(id => {
                if (id === 'totalClients') {
                    updateKPICard(id, 0);
                } else {
                    updateKPICard(id, 0);
                }
            });
            
            alert('Dados limpos! Todos os KPIs devem mostrar zero.');
        }
        
        async function testarAPI() {
            console.log('üåê Testando API real...');
            
            try {
                const response = await api.get('/dashboard/stats');
                console.log('üìä Resposta da API:', response);
                
                if (response && Object.keys(response).length > 0) {
                    alert('‚úÖ API retornou dados! Verifique se os KPIs foram atualizados.');
                } else {
                    alert('‚ö†Ô∏è API retornou dados vazios. KPIs devem mostrar zero.');
                }
            } catch (error) {
                console.error('‚ùå Erro na API:', error);
                alert('‚ùå Erro ao acessar API: ' + error.message);
            }
        }
        
        function verificarHTML() {
            console.log('üîç Verificando HTML...');
            
            // Verificar se h√° valores hardcoded no HTML
            const htmlContent = document.documentElement.outerHTML;
            const valoresProblema = ['R$ 3,83', 'R$ 11,50', 'R$ 13,00'];
            const problemas = valoresProblema.filter(valor => htmlContent.includes(valor));
            
            if (problemas.length > 0) {
                alert('‚ö†Ô∏è Valores hardcoded encontrados no HTML: ' + problemas.join(', '));
            } else {
                alert('‚úÖ Nenhum valor hardcoded encontrado no HTML!');
            }
        }
        
        function abrirDashboard() {
            window.open('index.html', '_blank');
        }
        
        function limparCache() {
            if ('caches' in window) {
                caches.keys().then(function(names) {
                    for (let name of names) {
                        caches.delete(name);
                    }
                });
            }
            alert('Cache limpo! Recarregando p√°gina...');
            location.reload();
        }
        
        // Verificar automaticamente ao carregar
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(verificarValores, 1000);
        });
    </script>
</body>
</html> 