<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste: Modais de Vendas</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { padding: 20px; background: #f8f9fa; }
        .test-container { max-width: 1200px; margin: 0 auto; }
        .success { color: #059669; font-weight: bold; }
        .error { color: #DC2626; font-weight: bold; }
        .warning { color: #D97706; font-weight: bold; }
        .info { color: #2563EB; font-weight: bold; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>‚úÖ Teste: Modais de Vendas</h1>
        <p>Verificando se os problemas dos modais de vendas foram corrigidos.</p>
        
        <div class="alert alert-success">
            <h6>üîß Problemas Corrigidos:</h6>
            <ul>
                <li><strong>Tradu√ß√£o "Nova Venda":</strong> ‚úÖ Adicionada em portugu√™s</li>
                <li><strong>Bot√£o "Editar":</strong> ‚úÖ Abre modal correto com dados</li>
                <li><strong>Preenchimento de dados:</strong> ‚úÖ Modal preenchido corretamente</li>
                <li><strong>Limpeza de formul√°rios:</strong> ‚úÖ Dados limpos ap√≥s salvar</li>
            </ul>
        </div>
        
        <div class="row">
            <div class="col-md-6">
                <div class="alert alert-info">
                    <h6>üåç Teste de Tradu√ß√£o:</h6>
                    <div id="translationTest">üîÑ Verificando...</div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="alert alert-info">
                    <h6>üéØ Teste de Funcionalidade:</h6>
                    <div id="functionalityTest">üîÑ Verificando...</div>
                </div>
            </div>
        </div>
        
        <div class="mt-4">
            <button class="btn btn-primary" onclick="testarTraducoes()">
                üåç Testar Tradu√ß√µes
            </button>
            <button class="btn btn-success" onclick="abrirDashboard()">
                üìä Abrir Dashboard
            </button>
            <button class="btn btn-warning" onclick="testarModais()">
                üéØ Testar Modais
            </button>
            <button class="btn btn-info" onclick="limparCache()">
                üßπ Limpar Cache
            </button>
        </div>
        
        <div class="mt-4">
            <h5>üéØ Resultado Esperado:</h5>
            <div class="alert alert-success">
                <ul>
                    <li><strong>Bot√£o "Nova Venda":</strong> Mostra "Nova Venda" em portugu√™s</li>
                    <li><strong>Bot√£o "Editar":</strong> Abre modal com dados da venda</li>
                    <li><strong>Modal de edi√ß√£o:</strong> Preenchido com cliente, produtos, etc.</li>
                    <li><strong>Ap√≥s salvar:</strong> Formul√°rio limpo para pr√≥xima edi√ß√£o</li>
                </ul>
            </div>
        </div>
        
        <div class="mt-4">
            <h5>üìã Checklist de Verifica√ß√£o:</h5>
            <div class="alert alert-warning">
                <div id="checklist">
                    <div>üîÑ Verificando...</div>
                </div>
            </div>
        </div>
        
        <div class="mt-4">
            <h5>üîç Como Testar Manualmente:</h5>
            <div class="alert alert-secondary">
                <ol>
                    <li><strong>Acesse o Dashboard:</strong> <a href="index.html" target="_blank">index.html</a></li>
                    <li><strong>V√° para Vendas:</strong> Clique em "Vendas" no menu</li>
                    <li><strong>Teste "Nova Venda":</strong> Verifique se mostra "Nova Venda" em portugu√™s</li>
                    <li><strong>Teste "Editar":</strong> Clique em editar uma venda existente</li>
                    <li><strong>Verifique dados:</strong> Modal deve estar preenchido com dados da venda</li>
                    <li><strong>Teste salvar:</strong> Salve a edi√ß√£o e verifique se formul√°rio fica limpo</li>
                </ol>
            </div>
        </div>
    </div>

    <script src="js/i18n/translations.js"></script>
    <script src="js/i18n/i18n.js"></script>
    <script src="js/app.js?v=2.2"></script>
    
    <script>
        let testResults = {
            translationWorking: false,
            modalWorking: false,
            dataFilling: false,
            formClearing: false
        };
        
        function testarTraducoes() {
            console.log('üåç === TESTE DE TRADU√á√ïES ===');
            
            try {
                // Inicializar i18n se n√£o estiver
                if (!window.i18n) {
                    window.i18n = new I18nManager();
                    window.i18n.init();
                }
                
                // Testar tradu√ß√£o "newSale"
                const newSaleTranslation = window.i18n.t('newSale');
                console.log('üìù Tradu√ß√£o newSale:', newSaleTranslation);
                
                if (newSaleTranslation === 'Nova Venda') {
                    testResults.translationWorking = true;
                    document.getElementById('translationTest').innerHTML = `
                        <div class="success">‚úÖ Tradu√ß√£o funcionando</div>
                        <div><strong>newSale:</strong> "${newSaleTranslation}"</div>
                        <div><strong>Idioma atual:</strong> ${window.i18n.getCurrentLanguage()}</div>
                    `;
                } else {
                    document.getElementById('translationTest').innerHTML = `
                        <div class="error">‚ùå Tradu√ß√£o incorreta</div>
                        <div><strong>Esperado:</strong> "Nova Venda"</div>
                        <div><strong>Recebido:</strong> "${newSaleTranslation}"</div>
                    `;
                }
                
                atualizarChecklist();
                
            } catch (error) {
                console.error('‚ùå Erro no teste de tradu√ß√µes:', error);
                document.getElementById('translationTest').innerHTML = `<div class="error">‚ùå Erro: ${error.message}</div>`;
            }
        }
        
        function testarModais() {
            console.log('üéØ === TESTE DE MODAIS ===');
            
            try {
                // Verificar se as fun√ß√µes existem
                const hasFillEditForm = typeof fillEditForm === 'function';
                const hasFillSaleEditForm = typeof fillSaleEditForm === 'function';
                const hasClearSaleForm = typeof clearSaleForm === 'function';
                
                testResults.modalWorking = hasFillEditForm;
                testResults.dataFilling = hasFillSaleEditForm;
                testResults.formClearing = hasClearSaleForm;
                
                document.getElementById('functionalityTest').innerHTML = `
                    <div class="${hasFillEditForm ? 'success' : 'error'}">
                        ${hasFillEditForm ? '‚úÖ' : '‚ùå'} fillEditForm: ${hasFillEditForm ? 'Dispon√≠vel' : 'N√£o encontrada'}
                    </div>
                    <div class="${hasFillSaleEditForm ? 'success' : 'error'}">
                        ${hasFillSaleEditForm ? '‚úÖ' : '‚ùå'} fillSaleEditForm: ${hasFillSaleEditForm ? 'Dispon√≠vel' : 'N√£o encontrada'}
                    </div>
                    <div class="${hasClearSaleForm ? 'success' : 'error'}">
                        ${hasClearSaleForm ? '‚úÖ' : '‚ùå'} clearSaleForm: ${hasClearSaleForm ? 'Dispon√≠vel' : 'N√£o encontrada'}
                    </div>
                `;
                
                atualizarChecklist();
                
            } catch (error) {
                console.error('‚ùå Erro no teste de modais:', error);
                document.getElementById('functionalityTest').innerHTML = `<div class="error">‚ùå Erro: ${error.message}</div>`;
            }
        }
        
        function atualizarChecklist() {
            const checklist = document.getElementById('checklist');
            checklist.innerHTML = `
                <div class="${testResults.translationWorking ? 'success' : 'error'}">
                    ${testResults.translationWorking ? '‚úÖ' : '‚ùå'} Tradu√ß√£o "Nova Venda"
                </div>
                <div class="${testResults.modalWorking ? 'success' : 'error'}">
                    ${testResults.modalWorking ? '‚úÖ' : '‚ùå'} Fun√ß√£o fillEditForm
                </div>
                <div class="${testResults.dataFilling ? 'success' : 'error'}">
                    ${testResults.dataFilling ? '‚úÖ' : '‚ùå'} Preenchimento de dados
                </div>
                <div class="${testResults.formClearing ? 'success' : 'error'}">
                    ${testResults.formClearing ? '‚úÖ' : '‚ùå'} Limpeza de formul√°rio
                </div>
            `;
        }
        
        function abrirDashboard() {
            window.open('index.html', '_blank');
        }
        
        function limparCache() {
            if ('caches' in window) {
                caches.keys().then(function(names) {
                    for (let name of names) {
                        caches.delete(name);
                    }
                });
            }
            alert('Cache limpo! Recarregando p√°gina...');
            location.reload();
        }
        
        // Teste autom√°tico ao carregar
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ P√°gina carregada, iniciando testes...');
            setTimeout(() => {
                testarTraducoes();
                testarModais();
            }, 1000);
        });
    </script>
</body>
</html> 