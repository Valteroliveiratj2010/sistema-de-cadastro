<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestor PRO</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="style.css">
    <style>
        /* CSS CRÍTICO PARA SIDEBAR - FORÇADO */
        @media (max-width: 991.98px) {
            .sidebar {
                width: 50% !important;
                max-width: 50% !important;
                min-width: 280px !important;
                transform: translateX(-100%) !important;
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                height: 100vh !important;
                z-index: 2000 !important;
                overflow-y: auto !important;
                transition: transform 0.3s ease !important;
            }
            
            .sidebar.active {
                transform: translateX(0) !important;
            }
            
            .sidebar .sidebar-title {
                padding-top: 4rem !important;
                margin-top: 0 !important;
                margin-bottom: 1rem !important;
            }
            
            .navbar-toggler {
                display: block !important;
                position: fixed !important;
                top: 1rem !important;
                left: 1rem !important;
                z-index: 2001 !important;
                background-color: #007bff !important;
                border: none !important;
                border-radius: 4px !important;
                padding: 0.5rem !important;
                color: white !important;
                cursor: pointer !important;
            }
            
            .overlay {
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                background-color: rgba(0, 0, 0, 0.5) !important;
                z-index: 1999 !important;
                opacity: 0 !important;
                visibility: hidden !important;
                transition: all 0.3s ease !important;
            }
            
            .overlay.active {
                opacity: 1 !important;
                visibility: visible !important;
            }
        }
        
        /* CORREÇÃO ESPECÍFICA PARA TELAS MENORES - GARANTIR 50% */
        @media (max-width: 768px) {
            .sidebar {
                width: 50% !important;
                max-width: 50% !important;
                min-width: 280px !important;
            }
        }
        
        @media (max-width: 576px) {
            .sidebar {
                width: 50% !important;
                max-width: 50% !important;
                min-width: 280px !important;
            }
        }
        
        @media (max-width: 480px) {
            .sidebar {
                width: 50% !important;
                max-width: 50% !important;
                min-width: 280px !important;
            }
        }
        
        /* SOBRESCREVER QUALQUER REGRA QUE DEFINA 100% - APENAS EM MOBILE/TABLET */
        @media (max-width: 991.98px) {
            .sidebar {
                width: 50% !important;
                max-width: 50% !important;
                min-width: 280px !important;
            }
        }
        
        /* CORREÇÃO IMEDIATA PARA LINKS DA SIDEBAR */
        .sidebar .nav-link {
            cursor: pointer !important;
            pointer-events: auto !important;
        }
        
        .sidebar .nav-link:hover {
            background-color: rgba(255, 255, 255, 0.1) !important;
        }
    </style>
</head>

<body>
    <button class="btn navbar-toggler d-lg-none" type="button" id="sidebarToggle" aria-label="Menu">
        <i class="bi bi-list text-white"></i>
    </button>

    <div id="app-container">
        <aside class="sidebar">
                            <h1 class="sidebar-title"><i class="bi bi-shield-check me-2"></i><span data-i18n="appTitle">Gestor PRO</span></h1>
                <div id="languageSelector" class="mt-3 mb-3"></div>
            <nav class="nav flex-column">
                <a class="nav-link active" href="#" data-section="dashboardSection"><i
                        class="bi bi-grid-1x2-fill me-2"></i>Dashboard</a>
                <a class="nav-link" href="#" data-section="clientsSection"><i
                        class="bi bi-people-fill me-2"></i>Clientes</a>
                <a class="nav-link" href="#" data-section="salesSection"><i
                        class="bi bi-cart-check-fill me-2"></i>Vendas</a>
                <a class="nav-link" href="#" data-section="reportsSection"><i
                        class="bi bi-graph-up me-2"></i>Relatórios</a>
                <a class="nav-link" href="#" data-section="productsSection"><i
                        class="bi bi-box-seam me-2"></i>Produtos</a>
                <a class="nav-link" href="#" data-section="usersSection"><i
                        class="bi bi-person-gear me-2"></i>Utilizadores</a>
                <a class="nav-link" href="#" data-section="suppliersSection"><i
                        class="bi bi-truck me-2"></i>Fornecedores</a>
                <a class="nav-link" href="#" data-section="purchasesSection"><i class="bi bi-bag me-2"></i>Compras</a>
                <a class="nav-link mt-auto" href="#" id="logoutButton" data-section="logoutSection"><i
                        class="bi bi-box-arrow-right me-2"></i>Sair</a>
            </nav>
        </aside>
        <main class="main-content" id="mainContent">
            <div class="content-wrapper">
                <section id="dashboardSection" class="content-section">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h2 class="mb-0"><i class="bi bi-grid-1x2 me-2"></i><span data-i18n="dashboard">Dashboard</span></h2>
                        <div class="d-flex gap-2">
                            <button class="btn btn-outline-primary" onclick="loadDashboardData()">
                                <i class="bi bi-arrow-clockwise me-2"></i>Atualizar
                            </button>
                        </div>
                    </div>

                    <!-- KPI Cards - Top Section (Primeira Linha) -->
                    <div class="row g-2 mb-3">
                        <div class="col-md-2">
                            <div class="card kpi-card text-center" id="totalClients">
                                <div class="card-body">
                                    <i class="bi bi-people-fill fs-1 text-primary mb-2"></i>
                                    <h6 class="card-title text-muted" data-i18n="totalClients">TOTAL DE CLIENTES</h6>
                                    <div class="fs-2 fw-bold text-primary">1</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="card kpi-card kpi-success text-center" id="salesThisMonth">
                                <div class="card-body">
                                    <i class="bi bi-cart-check-fill fs-1 text-success mb-2"></i>
                                    <h6 class="card-title text-muted" data-i18n="salesThisMonth">VENDAS DO MÊS</h6>
                                    <div class="fs-2 fw-bold text-success">R$ 0,00</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="card kpi-card kpi-info text-center" id="totalReceivable">
                                <div class="card-body">
                                    <i class="bi bi-cash-stack fs-1 text-info mb-2"></i>
                                    <h6 class="card-title text-muted" data-i18n="totalReceivable">A RECEBER</h6>
                                    <div class="fs-2 fw-bold text-info">R$ 13,00</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="card kpi-card kpi-warning text-center" id="totalAccountsPayable">
                                <div class="card-body">
                                    <i class="bi bi-credit-card-fill fs-1 text-warning mb-2"></i>
                                    <h6 class="card-title text-muted" data-i18n="totalAccountsPayable">A PAGAR</h6>
                                    <div class="fs-2 fw-bold text-warning">R$ 13,00</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="card kpi-card kpi-success text-center" id="profit">
                                <div class="card-body">
                                    <i class="bi bi-graph-up-arrow fs-1 text-success mb-2"></i>
                                    <h6 class="card-title text-muted" data-i18n="profit">LUCRO</h6>
                                    <div class="fs-2 fw-bold text-success">R$ 11,50</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- KPI Cards - Second Row (Segunda Linha) -->
                    <div class="row g-2 mb-4">
                        <div class="col-md-2">
                            <div class="card kpi-card text-center" id="orderValue">
                                <div class="card-body">
                                    <i class="bi bi-currency-dollar fs-1 text-primary mb-2"></i>
                                    <h6 class="card-title text-muted">VALOR DO PEDIDO</h6>
                                    <div class="fs-2 fw-bold text-primary">R$ 3,83</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="card kpi-card kpi-info text-center" id="averageTicket">
                                <div class="card-body">
                                    <i class="bi bi-receipt fs-1 text-info mb-2"></i>
                                    <h6 class="card-title text-muted">TICKET MÉDIO</h6>
                                    <div class="fs-2 fw-bold text-info">R$ 3,83</div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="card kpi-card kpi-danger text-center" id="overdueSales">
                                <div class="card-body">
                                    <i class="bi bi-exclamation-triangle-fill fs-1 text-danger mb-2"></i>
                                    <h6 class="card-title text-muted">VENDAS VENCIDAS</h6>
                                    <div class="fs-2 fw-bold text-danger">R$ 0,00</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Charts and Top Lists - Middle Section -->
                    <div class="row g-4 mb-4">
                        <!-- Sales Chart -->
                        <div class="col-lg-8">
                            <div class="card shadow-sm">
                                <div class="card-header" style="background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%); color: white;">
                                    <h5 class="mb-0"><i class="bi bi-bar-chart-line me-2"></i>Vendas Mensais (Comparativo Anual)</h5>
                                </div>
                                <div class="card-body">
                                    <canvas id="salesChart" height="300"></canvas>
                                </div>
                            </div>
                        </div>

                        <!-- Top Lists -->
                        <div class="col-lg-4">
                            <!-- Top Products -->
                            <div class="card shadow-sm mb-3">
                                <div class="card-header" style="background: linear-gradient(135deg, var(--primary-color) 0%, var(--primary-light) 100%); color: white;">
                                    <h6 class="mb-0"><i class="bi bi-box-seam me-2"></i>Top 5 Produtos Mais Vendidos</h6>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-sm" id="topProductsTable">
                                            <thead>
                                                <tr>
                                                    <th>Tabelas</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td class="text-center text-muted">Nenhum produto vendido</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                            <!-- Top Clients -->
                            <div class="card shadow-sm mb-3">
                                <div class="card-header" style="background: linear-gradient(135deg, var(--success-color) 0%, var(--secondary-light) 100%); color: white;">
                                    <h6 class="mb-0"><i class="bi bi-people me-2"></i>Top 5 Clientes com Mais Compras</h6>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-sm" id="topClientsTable">
                                            <thead>
                                                <tr>
                                                    <th>Cliente</th>
                                                    <th>Total</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>Dayse Oliveira</td>
                                                    <td>R$ 10,00</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                            <!-- Top Suppliers -->
                            <div class="card shadow-sm">
                                <div class="card-header" style="background: linear-gradient(135deg, var(--warning-color) 0%, #F59E0B 100%); color: white;">
                                    <h6 class="mb-0"><i class="bi bi-truck me-2"></i>Top 5 Fornecedores</h6>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-sm" id="topSuppliersTable">
                                            <thead>
                                                <tr>
                                                    <th>Fornecedor</th>
                                                    <th>Compras</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td colspan="2" class="text-center text-muted">Nenhum fornecedor encontrado</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Financial Maturities - Bottom Section -->
                    <div class="row g-4">
                        <!-- Overdue Accounts Receivable -->
                        <div class="col-lg-6">
                            <div class="card shadow-sm">
                                <div class="card-header" style="background: linear-gradient(135deg, var(--danger-color) 0%, #EF4444 100%); color: white;">
                                    <h6 class="mb-0"><i class="bi bi-exclamation-circle me-2"></i>Contas a Receber Vencidas</h6>
                                </div>
                                <div class="card-body">
                                    <div id="overdueReceivableContent">
                                        <p class="text-center text-muted">Nenhuma venda pendente encontrada.</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Overdue Accounts Payable -->
                        <div class="col-lg-6">
                            <div class="card shadow-sm">
                                <div class="card-header" style="background: linear-gradient(135deg, var(--danger-color) 0%, #EF4444 100%); color: white;">
                                    <h6 class="mb-0"><i class="bi bi-exclamation-triangle me-2"></i>Contas a Pagar Vencidas</h6>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-sm" id="overduePayableTable">
                                            <thead>
                                                <tr>
                                                    <th>ID</th>
                                                    <th>FORNECEDOR</th>
                                                    <th>VENCIMENTO</th>
                                                    <th>VALOR</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>1</td>
                                                    <td>Fornecedor</td>
                                                    <td>25/01/2023</td>
                                                    <td>R$ 200,00</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Upcoming Accounts Receivable -->
                        <div class="col-lg-6">
                            <div class="card shadow-sm">
                                <div class="card-header" style="background: linear-gradient(135deg, var(--warning-color) 0%, #F59E0B 100%); color: white;">
                                    <h6 class="mb-0"><i class="bi bi-calendar-event me-2"></i>Contas a Receber Próximas (30 dias)</h6>
                                </div>
                                <div class="card-body">
                                    <div id="upcomingReceivableContent">
                                        <p class="text-center text-muted">Nenhuma venda pendente encontrada.</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Upcoming Accounts Payable -->
                        <div class="col-lg-6">
                            <div class="card shadow-sm">
                                <div class="card-header" style="background: linear-gradient(135deg, var(--warning-color) 0%, #F59E0B 100%); color: white;">
                                    <h6 class="mb-0"><i class="bi bi-calendar-check me-2"></i>Contas a Pagar Próximas (30 dias)</h6>
                                </div>
                                <div class="card-body">
                                    <div id="upcomingPayableContent">
                                        <p class="text-center text-muted">Nenhuma compra pendente encontrada.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                <section id="clientsSection" class="content-section" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h2 class="mb-0"><i class="bi bi-people me-2"></i>Gerenciar Clientes</h2>
                        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#clientModal">
                            <i class="bi bi-plus-circle me-2"></i>Novo Cliente
                        </button>
                    </div>

                    <!-- Filtros e Busca -->
                    <div class="card shadow-sm mb-4">
                        <div class="card-body">
                            <div class="row g-3">
                                <div class="col-md-8">
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="bi bi-search"></i></span>
                                        <input type="text" class="form-control" placeholder="Buscar clientes por nome, email, telefone ou CPF/CNPJ..." data-search="clients">
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="d-flex gap-2">
                                        <button class="btn btn-outline-secondary" data-action="export" data-type="clients">
                                            <i class="bi bi-download me-2"></i>Exportar
                                        </button>
                                        <button class="btn btn-outline-secondary" data-action="print" data-type="clients">
                                            <i class="bi bi-printer me-2"></i>Imprimir
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tabela de Clientes -->
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover" id="clientsTable">
                                    <thead class="table-light">
                                        <tr>
                                            <th>Nome</th>
                                            <th>CPF/CNPJ</th>
                                            <th>Telefone</th>
                                            <th>Email</th>
                                            <th>Ações</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="5" class="text-center text-muted py-4">
                                                <i class="bi bi-people fs-1 d-block mb-2"></i>
                                                Nenhum cliente cadastrado
                                                <br>
                                                <small>Clique em "Novo Cliente" para adicionar o primeiro</small>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <!-- Paginação -->
                            <nav aria-label="Paginação de clientes">
                                <ul class="pagination justify-content-center mb-0" id="clientsPagination">
                                    <!-- Paginação será inserida dinamicamente -->
                                </ul>
                            </nav>
                        </div>
                    </div>
                </section>
                <section id="salesSection" class="content-section" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h2 class="mb-0"><i class="bi bi-cart-check me-2"></i>Gerenciar Vendas</h2>
                        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#saleModal">
                            <i class="bi bi-plus-circle me-2"></i>Nova Venda
                        </button>
                    </div>

                    <!-- Filtros e Busca -->
                    <div class="card shadow-sm mb-4">
                        <div class="card-body">
                            <div class="row g-3">
                                <div class="col-md-8">
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="bi bi-search"></i></span>
                                        <input type="text" class="form-control" placeholder="Buscar vendas por cliente, ID ou status..." data-search="sales">
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="d-flex gap-2">
                                        <button class="btn btn-outline-secondary" data-action="export" data-type="sales">
                                            <i class="bi bi-download me-2"></i>Exportar
                                        </button>
                                        <button class="btn btn-outline-secondary" data-action="print" data-type="sales">
                                            <i class="bi bi-printer me-2"></i>Imprimir
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tabela de Vendas -->
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover" id="salesTable">
                                    <thead class="table-light">
                                        <tr>
                                            <th>ID</th>
                                            <th>Cliente</th>
                                            <th>Valor Total</th>
                                            <th>Data</th>
                                            <th>Status</th>
                                            <th>Ações</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="6" class="text-center text-muted py-4">
                                                <i class="bi bi-cart-check fs-1 d-block mb-2"></i>
                                                Nenhuma venda registrada
                                                <br>
                                                <small>Clique em "Nova Venda" para adicionar a primeira</small>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <!-- Paginação -->
                            <nav aria-label="Paginação de vendas">
                                <ul class="pagination justify-content-center mb-0" id="salesPagination">
                                    <!-- Paginação será inserida dinamicamente -->
                                </ul>
                            </nav>
                        </div>
                    </div>
                </section>
                <section id="reportsSection" class="content-section" style="display: none;">
                    <h3 class="mb-4"><i class="bi bi-graph-up me-2"></i>Relatórios Financeiros e de Vendas</h3>

                    <div class="card shadow-sm mb-4">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0"><i class="bi bi-bar-chart-line me-2"></i>Relatório de Vendas por Período</h5>
                        </div>
                        <div class="card-body">
                            <form id="reportPeriodForm" data-action="generateSalesReport">
                                <div class="row g-3">
                                    <div class="col-md-5">
                                        <label for="startDate" class="form-label">Data Inicial</label>
                                        <input type="date" class="form-control" id="startDate" required>
                                    </div>
                                    <div class="col-md-5">
                                        <label for="endDate" class="form-label">Data Final</label>
                                        <input type="date" class="form-control" id="endDate" required>
                                    </div>
                                    <div class="col-md-2 d-flex align-items-end">
                                        <button type="submit" class="btn btn-primary w-100"><i class="bi bi-play-circle me-2"></i>Gerar Relatório</button>
                                    </div>
                                </div>
                            </form>
                            <hr class="my-4">
                            <div id="reportResults">
                                <p class="text-center text-muted">Selecione um período e clique em "Gerar Relatório" para ver os resultados.</p>
                            </div>
                        </div>
                    </div>

                    <div class="card shadow-sm mb-4">
                        <div class="card-header bg-success text-white">
                            <h5 class="mb-0"><i class="bi bi-currency-dollar me-2"></i>Fluxo de Caixa</h5>
                        </div>
                        <div class="card-body">
                            <form id="cashFlowReportForm" data-action="generateCashFlowReport">
                                <div class="row g-3">
                                    <div class="col-md-5">
                                        <label for="cashFlowStartDate" class="form-label">Data Inicial</label>
                                        <input type="date" class="form-control" id="cashFlowStartDate" required>
                                    </div>
                                    <div class="col-md-5">
                                        <label for="cashFlowEndDate" class="form-label">Data Final</label>
                                        <input type="date" class="form-control" id="cashFlowEndDate" required>
                                    </div>
                                    <div class="col-md-2 d-flex align-items-end">
                                        <button type="submit" class="btn btn-success w-100"><i class="bi bi-cash-stack me-2"></i>Gerar Fluxo</button>
                                    </div>
                                </div>
                            </form>
                            <hr class="my-4">
                            <div id="cashFlowReportResults">
                                <p class="text-center text-muted">Selecione um período e clique em "Gerar Fluxo" para ver o fluxo de caixa.</p>
                            </div>
                        </div>
                    </div>

                    <div class="card shadow-sm mb-4">
                        <div class="card-header bg-info text-white">
                            <h5 class="mb-0"><i class="bi bi-file-earmark-spreadsheet me-2"></i>Relatório Contábil Consolidado (CSV)</h5>
                        </div>
                        <div class="card-body">
                            <form id="accountingReportForm" data-action="exportAccountingReport">
                                <div class="row g-3">
                                    <div class="col-md-5">
                                        <label for="accountingStartDate" class="form-label">Data Inicial</label>
                                        <input type="date" class="form-control" id="accountingStartDate" required>
                                    </div>
                                    <div class="col-md-5">
                                        <label for="accountingEndDate" class="form-label">Data Final</label>
                                        <input type="date" class="form-control" id="accountingEndDate" required>
                                    </div>
                                    <div class="col-md-2 d-flex align-items-end">
                                        <button type="submit" class="btn btn-info w-100 text-white"><i class="bi bi-download me-2"></i>Exportar CSV</button>
                                    </div>
                                </div>
                            </form>
                            <p class="text-muted text-center mt-3 mb-0">Este relatório gera um arquivo CSV com todas as transações financeiras (entradas e saídas) do período.</p>
                        </div>
                    </div>
                    
                    <div class="card shadow-sm mb-4">
                        <div class="card-header bg-warning text-dark">
                            <h5 class="mb-0"><i class="bi bi-graph-up-arrow me-2"></i>Análise Preditiva de Vendas</h5>
                        </div>
                        <div class="card-body">
                            <form id="salesPredictionForm" data-action="generateSalesPrediction">
                                <div class="row g-3">
                                    <div class="col-md-10">
                                        <label for="predictionMonths" class="form-label">Histórico de Meses para Análise (3-24)</label>
                                        <input type="number" class="form-control" id="predictionMonths" value="12" min="3" max="24" required>
                                    </div>
                                    <div class="col-md-2 d-flex align-items-end">
                                        <button type="submit" class="btn btn-warning w-100"><i class="bi bi-lightbulb me-2"></i>Gerar Projeção</button>
                                    </div>
                                </div>
                            </form>
                            <hr class="my-4">
                            <div id="salesPredictionResults">
                                <p class="text-center text-muted">Selecione o histórico de meses e clique em "Gerar Projeção" para ver a análise.</p>
                            </div>
                        </div>
                    </div>

                    <section id="saleDetailSection" class="content-section" style="display: none;"></section>
                    <section id="purchaseDetailSection" class="content-section" style="display: none;"></section>

                </section>
                <section id="productsSection" class="content-section" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h2 class="mb-0"><i class="bi bi-box-seam me-2"></i>Gerenciar Produtos</h2>
                        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#productModal">
                            <i class="bi bi-plus-circle me-2"></i>Novo Produto
                        </button>
                    </div>

                    <!-- Filtros e Busca -->
                    <div class="card shadow-sm mb-4">
                        <div class="card-body">
                            <div class="row g-3">
                                <div class="col-md-8">
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="bi bi-search"></i></span>
                                        <input type="text" class="form-control" placeholder="Buscar produtos por nome, descrição ou SKU..." data-search="products">
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="d-flex gap-2">
                                        <button class="btn btn-outline-secondary" data-action="export" data-type="products">
                                            <i class="bi bi-download me-2"></i>Exportar
                                        </button>
                                        <button class="btn btn-outline-secondary" data-action="print" data-type="products">
                                            <i class="bi bi-printer me-2"></i>Imprimir
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tabela de Produtos -->
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover" id="productsTable">
                                    <thead class="table-light">
                                        <tr>
                                            <th>Nome</th>
                                            <th>Descrição</th>
                                            <th>Preço</th>
                                            <th>Estoque</th>
                                            <th>Status</th>
                                            <th>Ações</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="6" class="text-center text-muted py-4">
                                                <i class="bi bi-box-seam fs-1 d-block mb-2"></i>
                                                Nenhum produto cadastrado
                                                <br>
                                                <small>Clique em "Novo Produto" para adicionar o primeiro</small>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <!-- Paginação -->
                            <nav aria-label="Paginação de produtos">
                                <ul class="pagination justify-content-center mb-0" id="productsPagination">
                                    <!-- Paginação será inserida dinamicamente -->
                                </ul>
                            </nav>
                        </div>
                    </div>
                </section>
                <section id="usersSection" class="content-section" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h2 class="mb-0"><i class="bi bi-people-fill me-2"></i>Gerenciar Usuários</h2>
                        <div class="d-flex gap-2">
                            <button class="btn btn-outline-primary" onclick="loadUsers()">
                                <i class="bi bi-arrow-clockwise me-2"></i>Atualizar
                            </button>
                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#userModal">
                                <i class="bi bi-plus-circle me-2"></i>Novo Usuário
                            </button>
                        </div>
                    </div>

                    <!-- Filtros e Busca -->
                    <div class="card shadow-sm mb-4">
                        <div class="card-body">
                            <div class="row g-3">
                                <div class="col-md-8">
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="bi bi-search"></i></span>
                                        <input type="text" class="form-control" placeholder="Buscar usuários por username, email ou role..." data-search="users">
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="d-flex gap-2">
                                        <button class="btn btn-outline-secondary" data-action="export" data-type="users">
                                            <i class="bi bi-download me-2"></i>Exportar
                                        </button>
                                        <button class="btn btn-outline-secondary" data-action="print" data-type="users">
                                            <i class="bi bi-printer me-2"></i>Imprimir
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tabela de Usuários -->
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover" id="usersTable">
                                    <thead class="table-light">
                                        <tr>
                                            <th>Username</th>
                                            <th>Email</th>
                                            <th>Role</th>
                                            <th>Ações</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="4" class="text-center text-muted py-4">
                                                <i class="bi bi-people-fill fs-1 d-block mb-2"></i>
                                                Nenhum usuário cadastrado
                                                <br>
                                                <small>Clique em "Novo Usuário" para adicionar o primeiro</small>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <!-- Paginação -->
                            <nav aria-label="Paginação de usuários">
                                <ul class="pagination justify-content-center mb-0" id="usersPagination">
                                    <!-- Paginação será inserida dinamicamente -->
                                </ul>
                            </nav>
                        </div>
                    </div>
                </section>
                <section id="suppliersSection" class="content-section" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h2 class="mb-0"><i class="bi bi-truck me-2"></i>Gerenciar Fornecedores</h2>
                        <div class="d-flex gap-2">
                            <button class="btn btn-outline-primary" onclick="loadSuppliers()">
                                <i class="bi bi-arrow-clockwise me-2"></i>Atualizar
                            </button>
                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#supplierModal">
                                <i class="bi bi-plus-circle me-2"></i>Novo Fornecedor
                            </button>
                        </div>
                    </div>

                    <!-- Filtros e Busca -->
                    <div class="card shadow-sm mb-4">
                        <div class="card-body">
                            <div class="row g-3">
                                <div class="col-md-8">
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="bi bi-search"></i></span>
                                        <input type="text" class="form-control" placeholder="Buscar fornecedores por nome, CNPJ, email ou telefone..." data-search="suppliers">
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="d-flex gap-2">
                                        <button class="btn btn-outline-secondary" data-action="export" data-type="suppliers">
                                            <i class="bi bi-download me-2"></i>Exportar
                                        </button>
                                        <button class="btn btn-outline-secondary" data-action="print" data-type="suppliers">
                                            <i class="bi bi-printer me-2"></i>Imprimir
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tabela de Fornecedores -->
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover" id="suppliersTable">
                                    <thead class="table-light">
                                        <tr>
                                            <th>Nome</th>
                                            <th>CNPJ</th>
                                            <th>Telefone</th>
                                            <th>Email</th>
                                            <th>Ações</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="5" class="text-center text-muted py-4">
                                                <i class="bi bi-truck fs-1 d-block mb-2"></i>
                                                Nenhum fornecedor cadastrado
                                                <br>
                                                <small>Clique em "Novo Fornecedor" para adicionar o primeiro</small>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <!-- Paginação -->
                            <nav aria-label="Paginação de fornecedores">
                                <ul class="pagination justify-content-center mb-0" id="suppliersPagination">
                                    <!-- Paginação será inserida dinamicamente -->
                                </ul>
                            </nav>
                        </div>
                    </div>
                </section>
                <section id="purchasesSection" class="content-section" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h2 class="mb-0"><i class="bi bi-cart-plus me-2"></i>Gerenciar Compras</h2>
                        <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#purchaseModal">
                            <i class="bi bi-plus-circle me-2"></i>Nova Compra
                        </button>
                    </div>

                    <!-- Filtros e Busca -->
                    <div class="card shadow-sm mb-4">
                        <div class="card-body">
                            <div class="row g-3">
                                <div class="col-md-8">
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="bi bi-search"></i></span>
                                        <input type="text" class="form-control" placeholder="Buscar compras por fornecedor, ID ou status..." data-search="purchases">
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="d-flex gap-2">
                                        <button class="btn btn-outline-secondary" data-action="export" data-type="purchases">
                                            <i class="bi bi-download me-2"></i>Exportar
                                        </button>
                                        <button class="btn btn-outline-secondary" data-action="print" data-type="purchases">
                                            <i class="bi bi-printer me-2"></i>Imprimir
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tabela de Compras -->
                    <div class="card shadow-sm">
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover" id="purchasesTable">
                                    <thead class="table-light">
                                        <tr>
                                            <th>ID</th>
                                            <th>Fornecedor</th>
                                            <th>Valor Total</th>
                                            <th>Data</th>
                                            <th>Status</th>
                                            <th>Ações</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td colspan="6" class="text-center text-muted py-4">
                                                <i class="bi bi-cart-plus fs-1 d-block mb-2"></i>
                                                Nenhuma compra registrada
                                                <br>
                                                <small>Clique em "Nova Compra" para adicionar a primeira</small>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <!-- Paginação -->
                            <nav aria-label="Paginação de compras">
                                <ul class="pagination justify-content-center mb-0" id="purchasesPagination">
                                    <!-- Paginação será inserida dinamicamente -->
                                </ul>
                            </nav>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>
    <div id="sidebar-overlay" class="overlay"></div>

    <div class="modal fade" id="clientModal" tabindex="-1" aria-labelledby="clientModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="clientModalLabel">Novo Cliente</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="clientForm" data-action="createClient">
                        <input type="hidden" name="id" id="clientId">
                        <div class="mb-3">
                            <label for="clientName" class="form-label">Nome</label>
                            <input type="text" class="form-control" id="clientName" name="nome" required>
                        </div>
                        <div class="mb-3">
                            <label for="clientEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="clientEmail" name="email">
                        </div>
                        <div class="mb-3">
                            <label for="clientPhone" class="form-label">Telefone</label>
                            <input type="text" class="form-control" id="clientPhone" name="telefone">
                        </div>
                        <div class="mb-3">
                            <label for="clientCpfCnpj" class="form-label">CPF/CNPJ</label>
                            <input type="text" class="form-control" id="clientCpfCnpj" name="cpfCnpj">
                        </div>
                        <div class="mb-3">
                            <label for="clientAddress" class="form-label">Endereço</label>
                            <textarea class="form-control" id="clientAddress" name="endereco" rows="3"></textarea>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                            <button type="submit" class="btn btn-primary">Salvar Cliente</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="saleModal" tabindex="-1" aria-labelledby="saleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" style="max-width: 600px !important; width: 600px !important;">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="saleModalLabel">Nova Venda</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="saleForm" data-action="createSale">
                        <input type="hidden" id="saleId">
                        <div class="mb-3">
                            <label for="saleClient" class="form-label">Cliente</label>
                            <select class="form-select" id="saleClient" required></select>
                        </div>
                        <div class="card mb-3">
                            <div class="card-header">Produtos da Venda</div>
                            <div class="card-body">
                                <div id="saleProductsList" class="mb-2" style="max-height: 150px; overflow-y: auto;">
                                    <p class="text-muted text-center m-0">Nenhum produto adicionado.</p>
                                </div>
                                <div class="row g-2 align-items-end">
                                    <div class="col-md-5">
                                        <label for="productSelect" class="form-label">Produto</label>
                                        <select class="form-control" id="productSelect" style="width: 100%;"></select>
                                    </div>
                                    <div class="col-md-2">
                                        <label for="productQuantity" class="form-label">Qtd</label>
                                        <input type="number" class="form-control" id="productQuantity" value="1"
                                            min="1">
                                    </div>
                                    <div class="col-md-5">
                                        <label for="productUnitPrice" class="form-label">Preço Unit.</label>
                                        <input type="number" step="0.01" class="form-control" id="productUnitPrice"
                                            placeholder="Preço" readonly>
                                    </div>
                                </div>
                                <div class="row mt-3">
                                    <div class="col-12">
                                        <button type="button" class="btn btn-primary" id="btnAddProduct"
                                            title="Adicionar Produto">
                                            <i class="fas fa-plus me-2"></i>Adicionar Produto
                                        </button>
                                    </div>
                                </div>
                                <div id="productDetailsDisplay" class="text-muted small mt-2 text-start"></div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="saleTotalValueDisplay" class="form-label">Valor Total da Venda</label>
                                <input type="text" class="form-control fw-bold" id="saleTotalValueDisplay" readonly
                                    value="R$ 0,00">
                                <input type="hidden" id="saleTotalValue" value="0">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="saleDueDate" class="form-label">Data de Vencimento</label>
                                <input type="date" class="form-control" id="saleDueDate">
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header">Pagamento Inicial</div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6 mb-3">
                                        <label for="salePaidValueInitial" class="form-label">Valor Pago</label>
                                        <input type="number" step="0.01" class="form-control" id="salePaidValueInitial"
                                            value="0">
                                    </div>
                                    <div class="col-md-6 mb-3">
                                        <label for="paymentForma" class="form-label">Forma de Pagamento</label>
                                        <select class="form-select" id="paymentForma">
                                            <option value="Dinheiro">Dinheiro</option>
                                            <option value="Cartão de Crédito">Cartão de Crédito</option>
                                            <option value="Crediário">Crediário</option>
                                            <option value="PIX">PIX</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="row" id="paymentDetailsFields">
                                    <div class="col-md-6 mb-3" id="parcelasField" style="display: none;">
                                        <label for="paymentParcelas" class="form-label">Parcelas</label>
                                        <input type="number" class="form-control" id="paymentParcelas" value="1"
                                            min="1">
                                    </div>
                                    <div class="col-md-6 mb-3" id="bandeiraCartaoField" style="display: none;">
                                        <label for="paymentBandeiraCartao" class="form-label">Bandeira Cartão</label>
                                        <input type="text" class="form-control" id="paymentBandeiraCartao"
                                            placeholder="Ex: Visa, Mastercard">
                                    </div>
                                    <div class="col-md-12 mb-3" id="bancoCrediarioField" style="display: none;">
                                        <label for="paymentBancoCrediario" class="form-label">Banco/Instituição
                                            Crediário</label>
                                        <input type="text" class="form-control" id="paymentBancoCrediario"
                                            placeholder="Ex: Banco X, Financeira Y">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer mt-3">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                            <button type="submit" class="btn btn-primary">Salvar Venda</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="productModal" tabindex="-1" aria-labelledby="productModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="productModalLabel">Novo Produto</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="productForm" data-action="createProduct">
                        <input type="hidden" name="id" id="productId">
                        <div class="mb-3">
                            <label for="productName" class="form-label">Nome</label>
                            <input type="text" class="form-control" id="productName" name="nome" required>
                        </div>
                        <div class="mb-3">
                            <label for="productDescription" class="form-label">Descrição</label>
                            <textarea class="form-control" id="productDescription" name="descricao" rows="3"></textarea>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="productPrice" class="form-label">Preço de Venda</label>
                                <input type="number" step="0.01" class="form-control" id="productPrice" name="preco" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="productCost" class="form-label">Preço de Custo</label>
                                <input type="number" step="0.01" class="form-control" id="productCost" name="custo">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="productStock" class="form-label">Estoque</label>
                                <input type="number" class="form-control" id="productStock" name="estoque" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="productSku" class="form-label">SKU</label>
                                <input type="text" class="form-control" id="productSku" name="sku">
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                            <button type="submit" class="btn btn-primary">Salvar Produto</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="confirmModal" tabindex="-1" aria-labelledby="confirmModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="confirmModalLabel">Confirmar Ação</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p id="confirmModalMessage">Você tem certeza?</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-danger" id="confirmModalButton">Confirmar</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="userModal" tabindex="-1" aria-labelledby="userModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="userModalLabel">Novo Usuário</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="userForm" data-action="createUser">
                        <input type="hidden" name="id" id="userId">
                        <div class="mb-3">
                            <label for="userName" class="form-label">Nome de Usuário</label>
                            <input type="text" class="form-control" id="userName" name="username" required>
                        </div>
                        <div class="mb-3">
                            <label for="userEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="userEmail" name="email" required>
                        </div>
                        <div class="mb-3">
                            <label for="userPassword" class="form-label">Senha</label>
                            <input type="password" class="form-control" id="userPassword" name="password" placeholder="Senha" autocomplete="current-password">
                        </div>
                        <div class="mb-3">
                            <label for="userRole" class="form-label">Função</label>
                            <select class="form-select" id="userRole" name="role">
                                <option value="vendedor">Vendedor</option>
                                <option value="gerente">Gerente</option>
                                <option value="admin">Admin</option>
                            </select>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                            <button type="submit" class="btn btn-primary">Salvar Usuário</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="supplierModal" tabindex="-1" aria-labelledby="supplierModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="supplierModalLabel">Novo Fornecedor</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="supplierForm" data-action="createSupplier">
                        <input type="hidden" name="id" id="supplierId">
                        <div class="mb-3">
                            <label for="supplierName" class="form-label">Nome</label>
                            <input type="text" class="form-control" id="supplierName" name="nome" required>
                        </div>
                        <div class="mb-3">
                            <label for="supplierContact" class="form-label">Contato</label>
                            <input type="text" class="form-control" id="supplierContact" name="contato">
                        </div>
                        <div class="mb-3">
                            <label for="supplierEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="supplierEmail" name="email">
                        </div>
                        <div class="mb-3">
                            <label for="supplierCnpj" class="form-label">CNPJ</label>
                            <input type="text" class="form-control" id="supplierCnpj" name="cnpj">
                        </div>
                        <div class="mb-3">
                            <label for="supplierAddress" class="form-label">Endereço</label>
                            <input type="text" class="form-control" id="supplierAddress" name="endereco">
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                            <button type="submit" class="btn btn-primary">Salvar Fornecedor</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="purchaseModal" tabindex="-1" aria-labelledby="purchaseModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" style="max-width: 600px !important; width: 600px !important;">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="purchaseModalLabel">Nova Compra</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="purchaseForm" data-action="createPurchase">
                        <input type="hidden" id="purchaseId">
                        <div class="mb-3">
                            <label for="purchaseSupplier" class="form-label">Fornecedor</label>
                            <select class="form-select" id="purchaseSupplier" required></select>
                        </div>
                        <div class="mb-3">
                            <label for="purchaseDate" class="form-label">Data da Compra</label>
                            <input type="date" class="form-control" id="purchaseDate" required>
                        </div>

                        <div class="card mb-3">
                            <div class="card-header">Produtos da Compra</div>
                            <div class="card-body">
                                <div id="purchaseProductsList" class="mb-2"
                                    style="max-height: 150px; overflow-y: auto;">
                                    <p class="text-muted text-center m-0">Nenhum produto adicionado.</p>
                                </div>
                                <div class="row g-2 align-items-end">
                                    <div class="col-md-5">
                                        <label for="purchaseProductSelect" class="form-label">Produto</label>
                                        <select class="form-control" id="purchaseProductSelect"
                                            style="width: 100%;"></select>
                                    </div>
                                    <div class="col-md-2">
                                        <label for="purchaseProductQuantity" class="form-label">Qtd</label>
                                        <input type="number" class="form-control" id="purchaseProductQuantity" value="1"
                                            min="1">
                                    </div>
                                    <div class="col-md-5">
                                        <label for="purchaseProductCost" class="form-label">Preço Custo Unit.</label>
                                        <input type="number" step="0.01" class="form-control" id="purchaseProductCost"
                                            placeholder="Custo" required>
                                    </div>
                                </div>
                                <div class="row mt-3">
                                    <div class="col-12">
                                        <button type="button" class="btn btn-primary" id="btnAddPurchaseProduct"
                                            title="Adicionar Produto">
                                            <i class="fas fa-plus me-2"></i>Adicionar Produto
                                        </button>
                                    </div>
                                </div>
                                <div id="purchaseProductDetailsDisplay" class="text-muted small mt-2 text-start"></div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label for="purchaseTotalValueDisplay" class="form-label">Valor Total da Compra</label>
                            <input type="text" class="form-control fw-bold" id="purchaseTotalValueDisplay" readonly
                                value="R$ 0,00">
                            <input type="hidden" id="purchaseTotalValue" value="0">
                        </div>

                        <div class="mb-3">
                            <label for="purchaseStatus" class="form-label">Status</label>
                            <select class="form-select" id="purchaseStatus">
                                <option value="Concluída">Concluída</option>
                                <option value="Pendente">Pendente</option>
                                <option value="Cancelada">Cancelada</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="purchaseObservations" class="form-label">Observações</label>
                            <textarea class="form-control" id="purchaseObservations" rows="3"></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary w-100">Salvar Compra</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Detalhes do Cliente -->
    <div class="modal fade" id="clientDetailModal" tabindex="-1" aria-labelledby="clientDetailModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="clientDetailModalLabel">Detalhes do Cliente</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6 class="text-primary">Informações Pessoais</h6>
                            <table class="table table-borderless">
                                <tr>
                                    <td><strong>ID:</strong></td>
                                    <td id="detailClientId">-</td>
                                </tr>
                                <tr>
                                    <td><strong>Nome:</strong></td>
                                    <td id="detailClientName">-</td>
                                </tr>
                                <tr>
                                    <td><strong>Email:</strong></td>
                                    <td id="detailClientEmail">-</td>
                                </tr>
                                <tr>
                                    <td><strong>Telefone:</strong></td>
                                    <td id="detailClientPhone">-</td>
                                </tr>
                                <tr>
                                    <td><strong>CPF/CNPJ:</strong></td>
                                    <td id="detailClientCpfCnpj">-</td>
                                </tr>
                                <tr>
                                    <td><strong>Endereço:</strong></td>
                                    <td id="detailClientAddress">-</td>
                                </tr>
                            </table>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-primary">Informações do Sistema</h6>
                            <table class="table table-borderless">
                                <tr>
                                    <td><strong>Data de Criação:</strong></td>
                                    <td id="detailClientCreated">-</td>
                                </tr>
                                <tr>
                                    <td><strong>Última Atualização:</strong></td>
                                    <td id="detailClientUpdated">-</td>
                                </tr>
                            </table>
                            
                            <h6 class="text-primary mt-3">Estatísticas</h6>
                            <div class="row">
                                <div class="col-6">
                                    <div class="card bg-light">
                                        <div class="card-body text-center">
                                            <h5 class="card-title text-primary" id="detailClientSalesCount">0</h5>
                                            <p class="card-text small">Vendas</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="card bg-light">
                                        <div class="card-body text-center">
                                            <h5 class="card-title text-success" id="detailClientTotalSpent">R$ 0,00</h5>
                                            <p class="card-text small">Total Gasto</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                    <button type="button" class="btn btn-primary" id="editFromDetailBtn">
                        <i class="bi bi-pencil"></i> Editar Cliente
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Detalhes da Venda -->
    <div class="modal fade" id="saleDetailModal" tabindex="-1" aria-labelledby="saleDetailModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="saleDetailModalLabel">Detalhes da Venda</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6 class="text-primary">Informações da Venda</h6>
                            <table class="table table-borderless">
                                <tr>
                                    <td><strong>ID da Venda:</strong></td>
                                    <td id="detailSaleId">-</td>
                                </tr>
                                <tr>
                                    <td><strong>Cliente:</strong></td>
                                    <td id="detailSaleClient">-</td>
                                </tr>
                                <tr>
                                    <td><strong>Data da Venda:</strong></td>
                                    <td id="detailSaleDate">-</td>
                                </tr>
                                <tr>
                                    <td><strong>Valor Total:</strong></td>
                                    <td id="detailSaleTotal">-</td>
                                </tr>
                                <tr>
                                    <td><strong>Status:</strong></td>
                                    <td id="detailSaleStatus">-</td>
                                </tr>
                            </table>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-primary">Produtos da Venda</h6>
                            <div id="detailSaleProducts" class="table-responsive">
                                <table class="table table-sm">
                                    <thead>
                                        <tr>
                                            <th>Produto</th>
                                            <th>Qtd</th>
                                            <th>Preço Unit.</th>
                                            <th>Total</th>
                                        </tr>
                                    </thead>
                                    <tbody id="detailSaleProductsList">
                                        <tr>
                                            <td colspan="4" class="text-center text-muted">Carregando produtos...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <h6 class="text-primary mt-3">Pagamentos</h6>
                            <div id="detailSalePayments" class="table-responsive">
                                <table class="table table-sm">
                                    <thead>
                                        <tr>
                                            <th>Data</th>
                                            <th>Valor</th>
                                            <th>Forma</th>
                                        </tr>
                                    </thead>
                                    <tbody id="detailSalePaymentsList">
                                        <tr>
                                            <td colspan="3" class="text-center text-muted">Carregando pagamentos...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                    <button type="button" class="btn btn-primary" id="editSaleFromDetailBtn">
                        <i class="bi bi-pencil"></i> Editar Venda
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Detalhes da Compra -->
    <div class="modal fade" id="purchaseDetailModal" tabindex="-1" aria-labelledby="purchaseDetailModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="purchaseDetailModalLabel">Detalhes da Compra</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6 class="text-primary">Informações da Compra</h6>
                            <table class="table table-borderless">
                                <tr>
                                    <td><strong>ID da Compra:</strong></td>
                                    <td id="detailPurchaseId">-</td>
                                </tr>
                                <tr>
                                    <td><strong>Fornecedor:</strong></td>
                                    <td id="detailPurchaseSupplier">-</td>
                                </tr>
                                <tr>
                                    <td><strong>Data da Compra:</strong></td>
                                    <td id="detailPurchaseDate">-</td>
                                </tr>
                                <tr>
                                    <td><strong>Valor Total:</strong></td>
                                    <td id="detailPurchaseTotal">-</td>
                                </tr>
                                <tr>
                                    <td><strong>Status:</strong></td>
                                    <td id="detailPurchaseStatus">-</td>
                                </tr>
                                <tr>
                                    <td><strong>Observações:</strong></td>
                                    <td id="detailPurchaseObservations">-</td>
                                </tr>
                            </table>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-primary">Produtos da Compra</h6>
                            <div id="detailPurchaseProducts" class="table-responsive">
                                <table class="table table-sm">
                                    <thead>
                                        <tr>
                                            <th>Produto</th>
                                            <th>Qtd</th>
                                            <th>Preço Custo</th>
                                            <th>Total</th>
                                        </tr>
                                    </thead>
                                    <tbody id="detailPurchaseProductsList">
                                        <tr>
                                            <td colspan="4" class="text-center text-muted">Carregando produtos...</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                    <button type="button" class="btn btn-primary" id="editPurchaseFromDetailBtn">
                        <i class="bi bi-pencil"></i> Editar Compra
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Detalhes do Fornecedor -->
    <div class="modal fade" id="supplierDetailModal" tabindex="-1" aria-labelledby="supplierDetailModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="supplierDetailModalLabel">Detalhes do Fornecedor</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6 class="text-primary">Informações da Empresa</h6>
                            <table class="table table-borderless">
                                <tr>
                                    <td><strong>ID:</strong></td>
                                    <td id="detailSupplierId">-</td>
                                </tr>
                                <tr>
                                    <td><strong>Nome:</strong></td>
                                    <td id="detailSupplierName">-</td>
                                </tr>
                                <tr>
                                    <td><strong>Email:</strong></td>
                                    <td id="detailSupplierEmail">-</td>
                                </tr>
                                <tr>
                                    <td><strong>Telefone:</strong></td>
                                    <td id="detailSupplierPhone">-</td>
                                </tr>
                                <tr>
                                    <td><strong>CNPJ:</strong></td>
                                    <td id="detailSupplierCnpj">-</td>
                                </tr>
                                <tr>
                                    <td><strong>Endereço:</strong></td>
                                    <td id="detailSupplierAddress">-</td>
                                </tr>
                            </table>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-primary">Informações do Sistema</h6>
                            <table class="table table-borderless">
                                <tr>
                                    <td><strong>Data de Criação:</strong></td>
                                    <td id="detailSupplierCreated">-</td>
                                </tr>
                                <tr>
                                    <td><strong>Última Atualização:</strong></td>
                                    <td id="detailSupplierUpdated">-</td>
                                </tr>
                            </table>
                            
                            <h6 class="text-primary mt-3">Estatísticas</h6>
                            <div class="row">
                                <div class="col-6">
                                    <div class="card bg-light">
                                        <div class="card-body text-center">
                                            <h5 class="card-title text-primary" id="detailSupplierPurchasesCount">0</h5>
                                            <p class="card-text small">Compras</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-6">
                                    <div class="card bg-light">
                                        <div class="card-body text-center">
                                            <h5 class="card-title text-success" id="detailSupplierTotalSpent">R$ 0,00</h5>
                                            <p class="card-text small">Total Gasto</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                    <button type="button" class="btn btn-primary" id="editSupplierFromDetailBtn">
                        <i class="bi bi-pencil"></i> Editar Fornecedor
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Detalhes do Usuário -->
    <div class="modal fade" id="userDetailModal" tabindex="-1" aria-labelledby="userDetailModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="userDetailModalLabel">Detalhes do Usuário</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h6 class="text-primary">Informações da Conta</h6>
                            <table class="table table-borderless">
                                <tr>
                                    <td><strong>ID:</strong></td>
                                    <td id="detailUserId">-</td>
                                </tr>
                                <tr>
                                    <td><strong>Username:</strong></td>
                                    <td id="detailUserName">-</td>
                                </tr>
                                <tr>
                                    <td><strong>Email:</strong></td>
                                    <td id="detailUserEmail">-</td>
                                </tr>
                                <tr>
                                    <td><strong>Perfil:</strong></td>
                                    <td id="detailUserRole">-</td>
                                </tr>
                            </table>
                        </div>
                        <div class="col-md-6">
                            <h6 class="text-primary">Informações do Sistema</h6>
                            <table class="table table-borderless">
                                <tr>
                                    <td><strong>Data de Criação:</strong></td>
                                    <td id="detailUserCreated">-</td>
                                </tr>
                                <tr>
                                    <td><strong>Última Atualização:</strong></td>
                                    <td id="detailUserUpdated">-</td>
                                </tr>
                            </table>
                            
                            <h6 class="text-primary mt-3">Status da Conta</h6>
                            <div class="row">
                                <div class="col-12">
                                    <div class="card bg-light">
                                        <div class="card-body text-center">
                                            <h5 class="card-title text-success">Ativo</h5>
                                            <p class="card-text small">Conta Ativa</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                    <button type="button" class="btn btn-primary" id="editUserFromDetailBtn">
                        <i class="bi bi-pencil"></i> Editar Usuário
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <!-- Core Modules -->
    <script src="js/i18n/translations.js"></script>
    <script src="js/i18n/i18n.js"></script>
    <script src="js/api.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/app.js"></script>
    
    <script>
        // Função de logout inline robusta
        function performLogout() {
            console.log('Função performLogout chamada');
            
            if (confirm('Tem certeza que deseja sair?')) {
                console.log('Confirmado logout, limpando localStorage...');
                
                // Limpar localStorage
                localStorage.removeItem('token');
                localStorage.removeItem('user');
                localStorage.removeItem('jwtToken');
                localStorage.removeItem('userRole');
                localStorage.removeItem('userName');
                localStorage.removeItem('userId');
                
                // Limpar tudo por segurança
                localStorage.clear();
                
                console.log('localStorage limpo, redirecionando...');
                
                // Mostrar mensagem
                alert('Logout realizado com sucesso!');
                
                // Redirecionar para login
                window.location.href = 'login.html';
            }
        }
        
        // Função global para logout via console
        window.forceLogout = function() {
            console.log('Logout forçado via console');
            localStorage.clear();
            alert('Logout forçado realizado!');
            window.location.href = 'login.html';
        };
        
        // Adicionar event listener ao botão de logout como backup
        document.addEventListener('DOMContentLoaded', function() {
            const logoutButton = document.getElementById('logoutButton');
            if (logoutButton) {
                console.log('Botão de logout encontrado, adicionando event listener...');
                logoutButton.addEventListener('click', function(e) {
                    e.preventDefault();
                    console.log('Clique no botão de logout detectado');
                    performLogout();
                });
            } else {
                console.log('Botão de logout não encontrado!');
            }
        });
    </script>
    <script src="js/test-crud-system.js"></script>
    <script src="js/debug-auth.js"></script>
    <script src="js/test-restore-functionality.js"></script>
    <script src="js/test-complete-restore.js"></script>
    <script src="js/quick-fix-test.js"></script>
    <script src="js/final-test.js"></script>
    <script src="js/diagnose-issues.js"></script>
    <script src="js/simple-client-test.js"></script>
    <script src="js/test-product-creation.js"></script>
    <script src="js/sku-generator.js"></script>
    <script src="js/test-product-display.js"></script>
    <script src="js/test-product-delete.js"></script>
    <script src="js/test-product-edit.js"></script>
    <script src="js/test-client-creation.js"></script>
    <script src="js/test-functions-exposed.js"></script>
    <script src="js/final-cleanup.js"></script>
    <script src="js/debug-client-submit.js"></script>
    <script src="js/fix-client-submit.js"></script>
    <script src="js/test-api-client.js"></script>
    <script src="js/test-client-fix.js"></script>
    <script src="js/test-client-display.js"></script>
    <script src="js/test-client-display-fix.js"></script>
    <script src="js/test-client-routes.js"></script>
    <script src="js/test-client-edit.js"></script>
    <script src="js/test-client-details.js"></script>
    <script>
        // Definir datas padrão para relatórios
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date();
            const firstDayOfMonth = new Date(today.getFullYear(), today.getMonth(), 1);
            
            // Formatar datas para input type="date" (YYYY-MM-DD)
            const todayStr = today.toISOString().split('T')[0];
            const firstDayStr = firstDayOfMonth.toISOString().split('T')[0];
            
            // Definir datas padrão para relatórios
            const dateFields = [
                'startDate', 'endDate',
                'cashFlowStartDate', 'cashFlowEndDate',
                'accountingStartDate', 'accountingEndDate'
            ];
            
            dateFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) {
                    if (fieldId.includes('Start')) {
                        field.value = firstDayStr;
                    } else if (fieldId.includes('End')) {
                        field.value = todayStr;
                    }
                }
            });
        });
    </script>
</body>

</html>